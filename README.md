# Marketplace api: README

## Архитектура проекта

### **Чистая архитектура**
- **Архитектура**: "Контроллер → Сервис → Репозиторий"
- **Назначение**: Чёткое разделение HTTP-слоя, бизнес-логики и доступа к данным
- **Преимущества**: Упрощает тестирование, повышает заменяемость реализаций
- **Расположение**:
  -  Контроллеры: `app/Http/Controllers/Api/V1/*`
  -  Сервисы: `app/Services/*`
  -  Репозитории: `app/Repositories/*`

---

## Безопасность и аутентификация

### **Аутентификация с токенами**
- **Метод**: Personal Access Tokens для API-доступа
- **Функционал**: Регистрация, вход, управление токенами
- **Ключевые компоненты**:
  - `AuthController.php` - управление аутентификацией
  - `app/DTO/*` - Data Transfer Objects
  - Миграция токенов: `2025_05_26_173423_create_personal_access_tokens_table.php`

### **Система ролей и прав**
- **Защита**: Middleware для административных эндпоинтов
- **Компоненты**:
  - `AdminMiddleware.php` - проверка прав доступа
  - `Role.php` - модель ролей
  - Миграции системы ролей

---

## Производительность и кеширование

### **Redis - многоцелевое использование**
 **Основные назначения**:

| Назначение | Преимущества | Компоненты |
|------------|--------------|------------|
| **Корзина покупок** | Быстрый доступ, долговременное хранение | `CartRepository.php`, `CartService.php` |
| **Кеширование данных** | Снижение нагрузки на БД, ускорение ответов | `ProductService.php`, `ProductRepository.php` |

---

## Асинхронная обработка

### **Очереди RabbitMQ**
- **Назначение**: Фоновая обработка ресурсоёмких задач
- **Преимущества**: Не блокирует поток выполнения
- **Пример использования**:
  - Отправка логов
  - Внешние интеграции (Telegram API)

### **Telegram-логирование**
- **Назначение**: Мгновенные уведомления администратора
- **Особенности**: Асинхронная отправка через очереди
- **Реализация**: 
  - `TelegramLoggerService.php` - сервис логирования
  - Интеграция с `SendLogJob`

---

## Простая административная панель

### **Статистика и аналитика**
- **Функционал**: Сбор и визуализация ключевых метрик
- **Метрики**: Кол-во заказов, продуктов
- **Компоненты**:
  - `AdminController.php` - API для админ-панели
  - `StatisticsRepository.php` - агрегация данных
  - `StatisticsService.php` - бизнес-логика статистики

---

## Валидация данных

### **Система валидации**
- **Подход**: Централизованная валидация входных данных
- **Технологии**:
  -  `app/Http/Requests/*` - классы валидации
  -  `app/DTO/*` - Data Transfer Objects для типобезопасности

---

## База данных и тестовые данные

### **Миграции и структура**
- **Назначение**: Воспроизводимая схема БД
- **Компоненты**:
  -  Миграции БД
  -  Фабрики тестовых данных

---

## Тестирование

### **Комплексное покрытие**
- **Типы тестов**: Feature-тесты для API эндпоинтов
- **Покрытие**: Контроллеры, бизнес-логика, поведение системы

---

## Развертывание и разработка

### **Docker-окружение**
- **Назначение**: Воспроизводимая среда разработки
- **Сервисы**: БД, Redis, RabbitMQ, PHP-приложение
- **Конфигурация**:
  - `docker-compose.yml` - оркестрация сервисов
  - `.env.example` - шаблон переменных окружения
  - `phpunit.xml` - конфигурация тестирования

---

## Ключевые преимущества

| Область | Преимущество |
|---------|--------------|
| **Производительность** | Redis-кеширование, асинхронные очереди |
| **Безопасность** | JWT-аутентификация, система ролей |
| **Масштабируемость** | Чистая архитектура, разделение ответственности |
| **Мониторинг** | Telegram-уведомления, статистика |
| **Качество** | Комплексное тестирование, валидация DTO |
| **Развертывание** | Docker |

